---
# Homepage Services Configuration
# Redesign v2.0.0 - Organized by operational priority

# ============================================================================
# CLUSTER HEALTH - Immediate visibility of cluster state
# ============================================================================
- Cluster Health:
    - CoreDNS:
        icon: mdi-kubernetes
        href: https://headlamp.chocolandiadc.com
        description: "K3s cluster DNS"
        namespace: kube-system
        app: coredns
        widget:
          type: kubernetes
          cluster: default
          namespace: kube-system
          app: coredns
          podSelector: k8s-app=kube-dns

    - Metrics Server:
        icon: mdi-server-network
        description: "Cluster metrics (CPU/MEM)"
        namespace: kube-system
        app: metrics-server
        widget:
          type: kubernetes
          cluster: default
          namespace: kube-system
          app: metrics-server
          podSelector: k8s-app=metrics-server

    - Ingress Health:
        icon: traefik.svg
        description: "Traefik ingress (LB: 192.168.4.202)"
        widget:
          type: traefik
          url: http://traefik.traefik.svc.cluster.local:9100

    - DNS Health:
        icon: si-pihole
        href: https://pihole.chocolandiadc.com
        description: "Pi-hole DNS (LB: 192.168.4.200)"
        widget:
          type: pihole
          url: http://pihole-web.default.svc.cluster.local
          key: "{{HOMEPAGE_VAR_PIHOLE_API_KEY}}"

# ============================================================================
# CRITICAL INFRASTRUCTURE - Services that break others when down
# ============================================================================
- Critical Infrastructure:
    - Traefik:
        icon: traefik.svg
        description: "Reverse proxy | LB: 192.168.4.202"
        namespace: traefik
        app: traefik
        widget:
          type: traefik
          url: http://traefik.traefik.svc.cluster.local:9100

    - Pi-hole:
        icon: si-pihole
        href: https://pihole.chocolandiadc.com
        description: "Network DNS | LB: 192.168.4.200:53"
        namespace: default
        app: pihole
        widget:
          type: pihole
          url: http://pihole-web.default.svc.cluster.local
          key: "{{HOMEPAGE_VAR_PIHOLE_API_KEY}}"

    - PostgreSQL:
        icon: si-postgresql
        description: "Database | LB: 192.168.4.204:5432"
        namespace: postgresql
        app: postgres
        widget:
          type: kubernetes
          cluster: default
          namespace: postgresql
          app: postgres
          podSelector: app.kubernetes.io/name=postgres

    - Redis:
        icon: si-redis
        description: "Cache | LB: 192.168.4.203:6379"
        namespace: redis
        app: redis
        widget:
          type: kubernetes
          cluster: default
          namespace: redis
          app: redis
          podSelector: app.kubernetes.io/name=redis

# ============================================================================
# PLATFORM SERVICES - Operational and observability tools
# ============================================================================
- Platform Services:
    - ArgoCD:
        icon: argocd.svg
        href: https://argocd.chocolandiadc.com
        description: "GitOps CD | NodePort: 30080"
        namespace: argocd
        app: argocd-server
        widget:
          type: argocd
          url: http://argocd-server.argocd.svc.cluster.local
          key: "{{HOMEPAGE_VAR_ARGOCD_TOKEN}}"

    - Grafana:
        icon: grafana.svg
        href: https://grafana.chocolandiadc.com
        description: "Dashboards | NodePort: 30000"
        namespace: monitoring
        app: grafana
        widget:
          type: grafana
          url: http://kube-prometheus-stack-grafana.monitoring.svc.cluster.local
          username: "{{HOMEPAGE_VAR_GRAFANA_USER}}"
          password: "{{HOMEPAGE_VAR_GRAFANA_PASSWORD}}"

    - Headlamp:
        icon: kubernetes-dashboard.svg
        href: https://headlamp.chocolandiadc.com
        description: "K8s Web UI"
        namespace: headlamp
        app: headlamp
        widget:
          type: kubernetes
          cluster: default
          namespace: headlamp
          app: headlamp
          podSelector: app.kubernetes.io/name=headlamp

    - cert-manager:
        icon: cert-manager.svg
        description: "TLS certificates"
        namespace: cert-manager
        app: cert-manager
        widget:
          type: kubernetes
          cluster: default
          namespace: cert-manager
          app: cert-manager
          podSelector: app.kubernetes.io/name=cert-manager

# ============================================================================
# APPLICATIONS - User-facing workloads
# ============================================================================
- Applications:
    - Beersystem:
        icon: si-beer
        href: https://beer.chocolandiadc.com
        description: "Beer inventory | Private: 192.168.4.101:3001"
        namespace: beersystem
        app: beersystem
        siteMonitor: https://beer.chocolandiadc.com
        widget:
          type: kubernetes
          cluster: default
          namespace: beersystem
          app: beersystem
          podSelector: app=beersystem,component=backend

    - Homepage:
        icon: homepage.svg
        href: https://homepage.chocolandiadc.com
        description: "This dashboard"
        namespace: homepage
        app: homepage
        widget:
          type: kubernetes
          cluster: default
          namespace: homepage
          app: homepage
          podSelector: app=homepage

    - Prometheus:
        icon: si-prometheus
        description: "Metrics DB | kubectl port-forward -n monitoring svc/prometheus 9090"
        namespace: monitoring
        app: prometheus
        widget:
          type: prometheus
          url: http://kube-prometheus-stack-prometheus.monitoring.svc.cluster.local:9090

# ============================================================================
# STORAGE & DATA - Persistence layer
# ============================================================================
- Storage & Data:
    - Longhorn:
        icon: si-cncf
        href: https://longhorn.chocolandiadc.com
        description: "Distributed block storage"
        namespace: longhorn-system
        app: longhorn-ui
        widget:
          type: kubernetes
          cluster: default
          namespace: longhorn-system
          app: longhorn-ui
          podSelector: app=longhorn-ui

    - MinIO Console:
        icon: si-minio
        href: https://minio.chocolandiadc.com
        description: "S3 object storage | Private: 192.168.4.101:9001"
        namespace: minio
        app: minio
        widget:
          type: kubernetes
          cluster: default
          namespace: minio
          app: minio
          podSelector: app=minio

    - MinIO S3 API:
        icon: mdi-api
        href: http://s3.chocolandiadc.com
        description: "S3 API endpoint (Pi-hole DNS)"
        namespace: minio
        app: minio

# ============================================================================
# QUICK REFERENCE - Commands, IPs, and access patterns
# ============================================================================
- Quick Reference:
    - SSH Access:
        icon: mdi-console
        description: |
          Master1: ssh -i ~/.ssh/id_ed25519_k3s chocolim@192.168.4.101
          Nodo03: ssh -i ~/.ssh/id_ed25519_k3s chocolim@192.168.4.102
          Nodo04: ssh -i ~/.ssh/id_ed25519_k3s chocolim@192.168.4.104

    - Port Forwards:
        icon: mdi-transit-connection-variant
        description: |
          Prometheus: kubectl port-forward -n monitoring svc/kube-prometheus-stack-prometheus 9090
          Alertmanager: kubectl port-forward -n monitoring svc/kube-prometheus-stack-alertmanager 9093

    - MetalLB IPs:
        icon: mdi-ip-network
        description: |
          192.168.4.200 → Pi-hole DNS
          192.168.4.202 → Traefik Ingress
          192.168.4.203 → Redis
          192.168.4.204 → PostgreSQL
          Range: 192.168.4.200-210

    - Certificates:
        icon: mdi-certificate
        description: |
          Public: letsencrypt-production (*.chocolandiadc.com)
          Private: local-ca (*.chocolandiadc.local)
          CA cert: terraform/environments/chocolandiadc-mvp/chocolandia-local-ca.crt

    - Common Commands:
        icon: mdi-code-tags
        description: |
          kubectl get pods -A | grep -v Running
          kubectl top nodes && kubectl top pods -A
          kubectl get events -A --sort-by='.lastTimestamp' | tail -20
